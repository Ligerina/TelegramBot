# Telegram bot

## Pipeline
### Разработка
Для разработки необходимо использовать ветки, названные в формате `dev/add-something`.

После пуша такой ветки в Github-репозиторий будет запушен [Github-action](.github/workflows/deploy-on-dev.yml), запускающий автотесты по доработанному приложению.

Если тесты успешно пройдены, то необходимо создать Pull Request (PR) и дождаться одобрения от другого участника проекта.


### Тестирование
После того, как PR dev-ветки был одобрен, её необходимо смержить в ветку `test`, после чего запуститься [Github-action](.github/workflows/deploy-on-test.yml), который прогонит автотесты, создаст docker image с тегом `test` и запушит его на Dockerhub.
Предполагается, что перед мержем в `master`- ветку этот image будет тщательным образом протестирован.

### Промышленная эксплуатация
После тестирования функционала в ветке `test`, её необходимо влить в ветку `master`. Соответствующий [github-action](.github/workflows/deploy-on-prod.yml)  прогонит автотесты, создаст docker image с тегом `latest`, запушит его на Dockerhub, обновит запущенный на сервере контейнер на актуальную версию.

## Секреты репозитория
Для корректной работы всех github-actions в репозиторий должны быть добавлены секреты.

| Название               | Суть                                                      |
|:-----------------------|-----------------------------------------------------------|
| SERVER_HOST            | Адрес хоста сервера                                       |
| SERVER_USER            | Имя пользователя, от лица которого подключаемся к серверу |
| SERVER_SSH_KEY         | SSH-ключ для подключения к серверу                        |
| SERVER_SSH_PORT        | Номер SSH-порта сервера                                   |
| DOCKER_HUB_USERNAME    | Логин в Dockerhub                                         |
| DOCKER_HUB_PASSWORD    | Пароль в Dockerhub                                        |
| TELEGRAM_BOT_TOKEN_PROD | Токен для Telegram бота                                   |
| TELEGRAM_BOT_NAME_PROD | Имя Telegram бота                                         |
